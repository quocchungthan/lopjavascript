<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div>
        <input type="text" name="nhiemVuMoi" onkeyup="thucThiFunction(event)">
        <button onclick="thucThiLenhClear(event)"> Clear </button>
    </div>

    <div id="inRaDanhSachNhiemVu">

    </div>

    <script>
        var thucThiLenhClear = function (e) {
            localStorage.clear(); // không cần đối số
            // localStorage.removeItem(key) -> cần một đối số key
            var divInraDanhSachNhiemVu = document.getElementById('inRaDanhSachNhiemVu'); 
            divInraDanhSachNhiemVu.innerHTML = "";
            danhSachNhiemVu = [];
        }

        var danhSachNhiemVu = [];
        console.log('ngay khi trang web dc load len')
        var danhSachDangString = localStorage.getItem('danhSach');
        if (danhSachDangString != null) { // toán tử KHÁC : !=
            danhSachNhiemVu = JSON.parse(danhSachDangString);
        }
        //bài tập 0.3 in ra một div với mỗi nhiệm vụ lấy ra được từ localStorage.
        // dùng vòng lặp for -> gọi fuction inRaNhiemVu với mỗi phần từ ở trong danhSachNhiemVu
        for (var i = 0; i < danhSachNhiemVu.length; ++i) {
            inRaNhiemVu(danhSachNhiemVu[i]);
        }
        // bat su kien onKeyUp
        // bai tap 1 -> su dung tat ca cac su kien cua the input
        var thucThiFunction = function (e) {
            if (e.code == 'Enter') {
                console.log('lenh Enter');
                console.log(e.target.value); // truy cap thuoc tinh cua object
                var tenNhiemVuMoi = e.target.value;

                danhSachNhiemVu.push(tenNhiemVuMoi); // thuoc tinh cua kieu array -> co kieu du lieu la function
                // bai tap 2: thu su dung tat ca cac thuoc tinh co kieu la function cua array

                // Cookie -> bi gioi han dung luong 5kb
                // WebStorage -> localStorage & localStorage -> 10Mb
                console.log(danhSachNhiemVu);
                var danhSachNhiemVuDangString = JSON.stringify(danhSachNhiemVu); // chuyen array thanh string
                localStorage.setItem('danhSach', danhSachNhiemVuDangString);

                inRaNhiemVu(tenNhiemVuMoi);
                var theInput = e.target;
                theInput.value = "";
                //var danhSachDangArray = JSON.parse(danhSachNhiemVuDangString); // dao nguoc
                // set Item vào session storage -> mở tab Application của Devtools để kiểm tra
                // bài tập 0: suử dụng localStorage, để lưu danhSachNhiemVu và lấy ra khi load lại trang
            }
            //localStorage;//
            // setItem(key, value); // 2 string
            // getItem(key);
            // removeItem(key);
            // clear();

            // document.getElementByClassName ->

        };
        // function <ten> () { }
        // bai tap 0.1: tạo ra 1 thẻ div cho mỗi nhiệm vụ mới được tạo ra. decor bằng Css. 
        //bài tập 0.3 in ra một div với mỗi nhiệm vụ lấy ra được từ localStorage.
        // dùng vòng lặp for -> gọi fuction inRaNhiemVu với mỗi phần từ ở trong danhSachNhiemVu
        function inRaNhiemVu(tenNhiemVu) {
            // DOM - document object model
            var divInraDanhSachNhiemVu = document.getElementById('inRaDanhSachNhiemVu'); // DOM -> xem thuộc tính thẻ
            // sử dụng document.createElement để tạo checkbox và append vào banGhiNhiemVu
            
            var banGhiNhiemVu = document.createElement('div'); // DOM -> tạo thẻ
            banGhiNhiemVu.innerHTML = tenNhiemVu; // -> DOM chỉnh sửa thẻ.
            // 
            var checkboxMoi = document.createElement('input');
            checkboxMoi.setAttribute('type', 'checkbox');
            checkboxMoi.addEventListener('change', function(e) {
                // kich hoat - triggered.
                console.log(e.target);
                console.log(e.target.checked);
                if (e.target.checked) {
                    console.log('nhiem vu da bi xoa')
                    // danhSachNhiemVu
                }
            });
            banGhiNhiemVu.append(checkboxMoi);

            banGhiNhiemVu.classList.add('item');
            //https://pomofocus.io/
            // https://github.com/quocchungthan/lopjavascript
            divInraDanhSachNhiemVu.append(banGhiNhiemVu); // -> DOM chỉnh sửa thẻ.
        }
        // DOM -> them sua xoa cac the HTML
        // bài tập cuối: tìm hiểu các method khác của DOM
    </script>
</body>
</html>